# Cursor Rules - Salon App Project

## ğŸ¯ RÃˆGLE PRINCIPALE - ANALYSE OBLIGATOIRE

**AVANT TOUTE MODIFICATION OU CONTINUATION DE TÃ‚CHE :**
1. **TOUJOURS** analyser et rÃ©sumer l'Ã©tat actuel du projet
2. Lire les fichiers clÃ©s pertinents (main.dart, constants.dart, pubspec.yaml)
3. Consulter TODO_ARCHITECTURE.md pour connaÃ®tre les tÃ¢ches en cours
4. VÃ©rifier l'architecture actuelle avant de proposer des changements
5. Identifier les dÃ©pendances et la structure existante

**Cette rÃ¨gle est CRITIQUE pour Ã©viter de se perdre dans le projet.**

---

## ğŸ“‹ Contexte du Projet

**Salon App** - Application Flutter de rÃ©servation de salons de coiffure

### Architecture Actuelle (en migration)
- **Ancienne** : Variables globales, setState partout, pas de gestion d'Ã©tat centralisÃ©e
- **Nouvelle** : Clean Architecture + Riverpod + GoRouter (en cours de migration)
- **RÃ©fÃ©rence** : Voir TODO_ARCHITECTURE.md pour la liste complÃ¨te des tÃ¢ches

### Structure Actuelle
```
lib/
â”œâ”€â”€ constants.dart          # âš ï¸ Variables globales Ã  migrer
â”œâ”€â”€ main.dart
â”œâ”€â”€ Home_page/              # Interface client
â”œâ”€â”€ screen/                 # Ã‰crans principaux
â”œâ”€â”€ starting_screens/       # Authentification
â””â”€â”€ shopowner/              # Interface propriÃ©taire
```

### Structure Cible (Clean Architecture)
```
lib/
â”œâ”€â”€ core/                   # Infrastructure partagÃ©e
â”œâ”€â”€ features/               # Features modulaires (auth, salon, booking, etc.)
â”œâ”€â”€ shared/                 # Widgets/utilitaires partagÃ©s
â””â”€â”€ routes/                 # Navigation avec GoRouter
```

---

## ğŸ› ï¸ Stack Technique

### Actuel
- Flutter SDK: ^3.10.4
- Gestion d'Ã©tat: setState (Ã  migrer vers Riverpod)
- Navigation: Navigator.push (Ã  migrer vers GoRouter)
- HTTP: http package (Ã  migrer vers Dio)

### Cible
- **Gestion d'Ã©tat**: flutter_riverpod + riverpod_annotation
- **Navigation**: go_router
- **Network**: dio + retrofit
- **Architecture**: Clean Architecture (Domain/Data/Presentation)
- **Code Generation**: build_runner, freezed, json_serializable

---

## ğŸ“ RÃ¨gles de DÃ©veloppement

### 1. Architecture
- Suivre Clean Architecture : Domain â†’ Data â†’ Presentation
- Chaque feature doit Ãªtre indÃ©pendante et modulaire
- Utiliser Riverpod pour la gestion d'Ã©tat
- Utiliser GoRouter pour la navigation
- Ã‰viter les variables globales (utiliser des providers)

### 2. Code Quality
- Toujours corriger les erreurs de linter
- Supprimer le code mort et les imports non utilisÃ©s
- Utiliser des noms de variables descriptifs
- Commenter le code complexe
- Suivre les conventions Dart/Flutter

### 3. SÃ©curitÃ©
- Ne jamais hardcoder les URLs API (utiliser .env)
- Valider toutes les entrÃ©es utilisateur
- GÃ©rer correctement les erreurs rÃ©seau
- Utiliser multipart/form-data pour l'upload d'images

### 4. Tests
- CrÃ©er des tests unitaires pour les usecases
- CrÃ©er des tests pour les repositories
- Tester les providers Riverpod

### 5. Git & Versioning
- Commits clairs et descriptifs
- Une feature = une branche (si applicable)
- Ne pas commiter les fichiers .env

---

## ğŸ” Fichiers Importants Ã  Consulter

### Avant de commencer une tÃ¢che, lire :
1. `TODO_ARCHITECTURE.md` - Liste complÃ¨te des tÃ¢ches de migration
2. `ANALYSE_PROJET.md` - Analyse dÃ©taillÃ©e du projet
3. `pubspec.yaml` - DÃ©pendances actuelles
4. `lib/constants.dart` - Variables globales (Ã  migrer)
5. `lib/main.dart` - Point d'entrÃ©e

### Fichiers de rÃ©fÃ©rence pour l'architecture :
- Structure cible dans TODO_ARCHITECTURE.md
- Exemples d'implÃ©mentation dans ANALYSE_PROJET.md

---

## âš ï¸ Points d'Attention

### ProblÃ¨mes Connus
1. **Variables globales** dans constants.dart - Ã€ migrer vers des providers
2. **Upload d'image** non sÃ©curisÃ© - Ã€ corriger avec multipart
3. **Navigation** directe - Ã€ migrer vers GoRouter
4. **Gestion d'erreurs** insuffisante - Ã€ amÃ©liorer
5. **Code dupliquÃ©** - Ã€ refactoriser

### Erreurs de Linter
- 15 erreurs identifiÃ©es (voir ANALYSE_PROJET.md)
- Toujours corriger avant de commiter

---

## ğŸ¯ Workflow RecommandÃ©

### Pour chaque nouvelle tÃ¢che :
1. **Analyser** : Lire les fichiers pertinents et comprendre le contexte
2. **Planifier** : Identifier les fichiers Ã  modifier/crÃ©er
3. **ImplÃ©menter** : Suivre l'architecture Clean Architecture
4. **Tester** : VÃ©rifier que Ã§a fonctionne
5. **Nettoyer** : Corriger les erreurs de linter
6. **Documenter** : Mettre Ã  jour les TODOs si nÃ©cessaire

### Ordre de migration (prioritÃ©) :
1. Setup & Configuration
2. Feature Authentication
3. Navigation
4. Features mÃ©tier (Salon, Booking, Profile, Owner)
5. Cleanup & Tests

---

## ğŸ“š Conventions de Nommage

### Fichiers
- **Screens** : `*_screen.dart` (ex: `login_screen.dart`)
- **Widgets** : `*_widget.dart` (ex: `custom_button_widget.dart`)
- **Providers** : `*_providers.dart` (ex: `auth_providers.dart`)
- **Models** : `*_model.dart` (ex: `user_model.dart`)
- **Entities** : `*.dart` (ex: `user.dart`)
- **Repositories** : `*_repository.dart` ou `*_repository_impl.dart`
- **Usecases** : `*_usecase.dart` (ex: `login_usecase.dart`)

### Classes
- **Screens** : `*Screen` (ex: `LoginScreen`)
- **Widgets** : `*Widget` (ex: `CustomButtonWidget`)
- **Providers** : `*Notifier` ou `*Provider` (ex: `AuthNotifier`)
- **Models** : `*Model` (ex: `UserModel`)
- **Entities** : Nom simple (ex: `User`)
- **Repositories** : `*Repository` ou `*RepositoryImpl`
- **Usecases** : `*Usecase` (ex: `LoginUsecase`)

---

## ğŸ”„ Migration en Cours

### Ã‰tat Actuel
- Architecture ancienne avec variables globales
- Migration vers Clean Architecture en cours
- Suivre TODO_ARCHITECTURE.md pour la progression

### Ã€ NE PAS FAIRE
- âŒ CrÃ©er de nouvelles variables globales
- âŒ Utiliser Navigator.push directement (utiliser GoRouter)
- âŒ Utiliser setState dans les nouvelles features (utiliser Riverpod)
- âŒ Hardcoder les URLs API
- âŒ Ignorer les erreurs de linter

### Ã€ FAIRE
- âœ… Suivre Clean Architecture
- âœ… Utiliser Riverpod pour l'Ã©tat
- âœ… Utiliser GoRouter pour la navigation
- âœ… Utiliser .env pour les configurations
- âœ… CrÃ©er des tests
- âœ… Documenter le code

---

## ğŸ’¡ Notes Importantes

- Le projet est en **migration active** - certaines parties utilisent encore l'ancienne architecture
- Toujours vÃ©rifier si une feature est dÃ©jÃ  migrÃ©e avant de la modifier
- Consulter TODO_ARCHITECTURE.md pour voir l'Ã©tat d'avancement
- En cas de doute, analyser d'abord avant d'agir

---

## ğŸš¨ RAPPEL FINAL

**TOUJOURS ANALYSER LE PROJET AVANT DE CONTINUER UNE TÃ‚CHE**

Cette rÃ¨gle est la plus importante pour maintenir la cohÃ©rence du projet pendant la migration.

